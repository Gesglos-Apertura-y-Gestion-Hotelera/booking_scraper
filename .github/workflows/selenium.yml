name: Selenium Tests
on:
  push: # ‚Üê Se ejecuta en cada push del boton de actions/workflows run workflow en Github
    branches: [ main ]
  workflow_dispatch:  # API trigger
    inputs:
      script:
        description: 'Script a ejecutar'
        required: true
        default: 'clientes_diario'
        type: choice
        options:
          - clientes_diario
          - clientes_prevision
          - competencia_diario
          - competencia_prevision
          - seguimiento_diario
          - personalizado
          - update_df
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Build & Run Script
#      run: |
#        docker build -t selenium-app .
#        docker run -d --name selenium \
#          -p 4444:4444 -p 7900:7900 \
#          --shm-size=2g \
#          selenium-app \
#           "${{ inputs.script }}"

      run: |
          docker build -t selenium-app .
          docker run --rm --shm-size="2g" selenium-app ${{ github.event.inputs.script }}


    - name: Wait for Selenium
      run: sleep 10

    - name: Test connection
      run: |
        curl -f http://localhost:4444/status || echo "Selenium ready"